clear all:
load('data124.mat');
n=length(C);
folder = 'mix_Results';
subfolder=strcat(folder,'/data',int2str(n));
if ~exist(subfolder, 'dir')
    mkdir(subfolder);
end
baseFileName = strcat('data',int2str(n),'.xlsx');
fullFileNameexcel = fullfile(folder, baseFileName);
if exist(fullFileNameexcel, 'file')==2
  delete(fullFileNameexcel);
end
exceloutput=[];

[F,Fsquare,~] = gen_data(C,0);
[Finv,Fsquareinv,ldetC] = gen_data(C,1);

for s=2:(n-1)
    s
    lb=obtain_lb(C,n,s);
    subbaseFileName = strcat('data',int2str(n),'s',int2str(s),'.xlsx');
    % DDFact data
    subfullFileNameexcel = fullfile(subfolder, subbaseFileName);
    if exist(subfullFileNameexcel, 'file')==2
      delete(subfullFileNameexcel);
    end
    
    x0=s/n*ones(n,1);
    [x,obj,info_DDFact] = Knitro_DDFact(x0,s,C,0,F,Fsquare);
    [fixto0list,fixto1list] = varfix_DDFact(x,s,C,0,F,Fsquare);
    info_DDFact.fixnum_to0=length(fixto0list);
    info_DDFact.fixnum_to1=length(fixto1list);
    
    x0inv=(n-s)/n*ones(n,1);
    [x,obj,info_DDFact_comp] = Knitro_DDFact(x0inv,n-s,C,1,Finv,Fsquareinv);
    info_DDFact_comp.dualbound=info_DDFact_comp.dualbound+ldetC;
    [fixto0list,fixto1list] = varfix_DDFact(x,n-s,C,1,Finv,Fsquareinv);
    info_DDFact_comp.fixnum_to0=length(fixto0list);
    info_DDFact_comp.fixnum_to1=length(fixto1list);

    gamma=Linx_gamma(C,s);
    [x,obj,info_Linx] = Knitro_Linx(x0,s,C,gamma);
    [fixto0list,fixto1list] = varfix_Linx(x,s,C,gamma);
    info_Linx.fixnum_to0=length(fixto0list);
    info_Linx.fixnum_to1=length(fixto1list);

    mix_handle1=@mix_Fact_Linx;
    [x,obj,info_Mix1] = mix_alteritr(C,s,mix_handle1);
    
     mix_handle2=@mix_compFact_Linx;
    [x,obj,info_Mix2] = mix_alteritr(C,s,mix_handle2);
    
     mix_handle3=@mix_compFact_Fact;
    [x,obj,info_Mix3] = mix_alteritr(C,s,mix_handle3);
    
    exceloutput(end+1,:)=[n, s, info_DDFact.dualbound,   info_DDFact_comp.dualbound,info_Linx.dualbound,...
        info_Mix3.dualbound, info_Mix1.dualbound, info_Mix2.dualbound, ...
        info_DDFact.dualbound-lb, info_DDFact_comp.dualbound-lb,info_Linx.dualbound-lb, ...
        info_Mix3.dualbound-lb,info_Mix1.dualbound-lb, info_Mix2.dualbound-lb, ...
        info_DDFact.fixnum_to0, info_DDFact_comp.fixnum_to1, info_Linx.fixnum_to0, ...
        info_Mix3.fixnum_to0,info_Mix1.fixnum_to0, info_Mix2.fixnum_to0,  ...
        info_DDFact.fixnum_to1, info_DDFact_comp.fixnum_to0, info_Linx.fixnum_to1, ...
        info_Mix3.fixnum_to1, info_Mix1.fixnum_to1, info_Mix2.fixnum_to1, ...
        info_DDFact.fixnum_to0+info_DDFact.fixnum_to1, info_DDFact_comp.fixnum_to0+info_DDFact_comp.fixnum_to1, info_Linx.fixnum_to0+info_Linx.fixnum_to1, ...
        info_Mix3.fixnum_to0+info_Mix3.fixnum_to1,info_Mix1.fixnum_to0+info_Mix1.fixnum_to1, info_Mix2.fixnum_to0+info_Mix2.fixnum_to1,  ...
        info_Mix3.alpha, info_Mix1.alpha, info_Mix2.alpha,  ...
        info_DDFact.time, info_DDFact_comp.time,info_Linx.time,  ...
        info_Mix3.time,info_Mix1.time, info_Mix2.time,  ...
        info_DDFact.cputime,info_DDFact_comp.cputime, info_Linx.cputime,  ...
        info_Mix3.cputime, info_Mix1.cputime, info_Mix2.cputime];
    
end
title=["n", "s", "dualbound_DDFact", "dualbound_DDFactcomp","dualbound_Linx",...
    "Mix_bound DDFactcomp_DDFact","Mix_bound DDFact_Linx", "Mix_bound DDFactcomp_Linx", ...
    "Intgap_DDFact", "Intgap_DDFactcomp","Intgap_Linx", ...
    "Intgap DDFactcomp_DDFact","Intgap DDFact_Linx", "Intgap DDFactcomp_Linx",...
    "fixnumto0_DDFact", "fixnumto0_DDFactcomp","fixnumto0_Linx", ...
    "fixnumto0 DDFactcomp_DDFact","fixnumto0 DDFact_Linx", "fixnumto0 DDFactcomp_Linx", ...
    "fixnumto1_DDFact", "fixnumto1_DDFactcomp","fixnumto1_Linx", ...
    "fixnumto1 DDFactcomp_DDFact","fixnumto1 DDFact_Linx", "fixnumto1 DDFactcomp_Linx", ...
    "fixnumto DDFactcomp_DDFact","fixnumto DDFact_Linx", "fixnumto DDFactcomp_Linx", ...
    "fixnumto_DDFact", "fixnumto_DDFactcomp","fixnumto_Linx", ...
    "Mix_alpha DDFactcomp_DDFact","Mix_alpha DDFact_Linx", "Mix_alpha DDFactcomp_Linx", ...
    "wall_clock time_DDFact", "wall_clock time_DDFactcomp","wall_clock time_Linx", ...
    "Mix_time DDFactcomp_DDFact","Mix_time DDFact_Linx", "Mix_time DDFactcomp_Linx", ...
     "CPU time_DDFact","CPU time_DDFactcomp", "CPU time_Linx", ...
     "Mix_cputime DDFactcomp_DDFact","Mix_cputime DDFact_Linx", "Mix_cputime DDFactcomp_Linx"];
 
xlswrite(fullFileNameexcel ,title,1,'A1');
xlswrite(fullFileNameexcel ,exceloutput,1,'A2');
